<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don Onofre - Mercado & Delicatessen</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #8B4513; /* Marr√≥n para mercado */
            --secondary: #228B22; /* Verde para fresco/natural */
            --accent: #D2691E; /* Naranja para ofertas */
            --success: #2E8B57; /* Verde mar para √©xito */
            --light: #FFF8DC; /* Beige claro */
            --dark: #654321; /* Marr√≥n oscuro */
            --gray: #A9A9A9;
            --shadow: 0 10px 30px rgba(139, 69, 19, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FFF8DC 0%, #F5DEB3 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            background-image: url('https://images.unsplash.com/photo-1506368249639-73a05d6f6488?auto=format&fit=crop&w=1200');
            background-size: cover;
            background-position: center;
            color: white;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(139, 69, 19, 0.8);
        }

        .header > * {
            position: relative;
            z-index: 2;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--light);
        }

        .title {
            font-size: 2.8rem;
            color: white;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-family: 'Georgia', serif;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--light);
            max-width: 600px;
            margin: 0 auto;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Navigation */
        .categories {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 12px 25px;
            border: 2px solid var(--secondary);
            background: white;
            color: var(--secondary);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-btn.active,
        .category-btn:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-2px);
        }

        /* Products Section */
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--primary);
            position: relative;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--accent);
            display: inline-block;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .product-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            border: 1px solid #E6D5B8;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.15);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .product-badge.organic { background: var(--secondary); }
        .product-badge.new { background: #3498db; }
        .product-badge.limited { background: #9B59B6; }

        .product-image {
            height: 200px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 4rem;
        }

        .product-content {
            padding: 25px;
        }

        .product-name {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: var(--primary);
            font-weight: 600;
        }

        .product-description {
            color: var(--gray);
            margin-bottom: 15px;
            font-size: 0.95rem;
            min-height: 60px;
        }

        .product-features {
            margin: 15px 0;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 0.85rem;
            color: var(--dark);
        }

        .feature i {
            color: var(--success);
            width: 16px;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .product-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .product-price .old-price {
            font-size: 1rem;
            color: var(--gray);
            text-decoration: line-through;
            margin-right: 5px;
        }

        .buy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .buy-btn:hover {
            background: var(--accent);
            transform: scale(1.05);
        }

        /* Order Result */
        .order-result {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-top: 40px;
            display: none;
            animation: fadeIn 0.5s ease;
            border: 2px solid var(--primary);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .order-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .order-icon {
            font-size: 2rem;
            color: var(--primary);
        }

        .order-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .order-status {
            background: #FFF8DC;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            border-left: 4px solid var(--secondary);
        }

        .status-text {
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .order-id {
            font-size: 0.9rem;
            color: var(--gray);
            background: #F5E6D3;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            font-family: monospace;
        }

        .order-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .payment-link {
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .payment-link:hover {
            background: #1E6B47;
            transform: translateY(-3px);
        }

        .status-btn {
            background: var(--accent);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .status-btn:hover {
            background: #B85C14;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 25px;
            color: var(--dark);
            font-size: 0.9rem;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .store-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .title {
                font-size: 2.2rem;
            }
            
            .order-actions {
                flex-direction: column;
            }
            
            .payment-link, .status-btn {
                width: 100%;
                justify-content: center;
            }
            
            .categories {
                gap: 8px;
            }
            
            .category-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
        }

        /* Special offer banner */
        .offer-banner {
            background: linear-gradient(90deg, var(--accent), var(--primary));
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: var(--radius);
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.9; }
            50% { opacity: 1; }
            100% { opacity: 0.9; }
        }

        .cart-summary {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .cart-summary:hover {
            background: var(--accent);
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-store"></i>
                </div>
                <h1 class="title">Mercado Don Onofre</h1>
            </div>
            <p class="subtitle">Delicatessen, productos gourmet y alimentos</p>
            
            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px;">
                    <i class="fas fa-truck"></i> Env√≠o gratis desde ‚Ç≤ 100.000
                </span>
                <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px;">
                    <i class="fas fa-leaf"></i> Productos org√°nicos
                </span>
                <span style="background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px;">
                    <i class="fas fa-shield-alt"></i> Pago seguro con AdamsPay
                </span>
            </div>
        </header>

        <!-- Offer Banner -->
        <div class="offer-banner">
            <i class="fas fa-gift"></i> ¬°OFERTA ESPECIAL! 15% de descuento en tu primera compra usando el c√≥digo: DONONOFRE15
        </div>

        <!-- Categories -->
        <div class="categories">
            <button class="category-btn active" onclick="filterProducts('all')">
                <i class="fas fa-store"></i> Todos los productos
            </button>
            <button class="category-btn" onclick="filterProducts('gourmet')">
                <i class="fas fa-utensils"></i> Gourmet
            </button>
            <button class="category-btn" onclick="filterProducts('organic')">
                <i class="fas fa-leaf"></i> Org√°nicos
            </button>
            <button class="category-btn" onclick="filterProducts('drinks')">
                <i class="fas fa-wine-bottle"></i> Bebidas
            </button>
            <button class="category-btn" onclick="filterProducts('bakery')">
                <i class="fas fa-bread-slice"></i> Panader√≠a
            </button>
        </div>

        <!-- Products Section -->
        <section class="products">
            <h2 class="section-title">Nuestros Productos Destacados</h2>
            <div class="products-grid" id="products-container">
                <!-- Product 1: Jam√≥n Ib√©rico -->
                <div class="product-card" data-category="gourmet">
                    <div class="product-badge">GOURMET</div>
                    <div class="product-image">
                        <i class="fas fa-drumstick-bite"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Jam√≥n Ib√©rico de Bellota</h3>
                        <p class="product-description">Jam√≥n 100% ib√©rico de bellota, curaci√≥n 36 meses. Producto premium importado de Espa√±a.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Peso: 7-8 kg</div>
                            <div class="feature"><i class="fas fa-clock"></i> Curaci√≥n: 36 meses</div>
                            <div class="feature"><i class="fas fa-tag"></i> Denominaci√≥n de Origen</div>
                            <div class="feature"><i class="fas fa-shipping-fast"></i> Env√≠o refrigerado</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">
                                <span class="old-price">‚Ç≤ 1.800.000</span>
                                ‚Ç≤ 1.530.000
                            </div>
                            <button class="buy-btn" onclick="comprarProducto('Jam√≥n Ib√©rico de Bellota', 1530000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 2: Queso Artesanal -->
                <div class="product-card" data-category="gourmet organic">
                    <div class="product-badge organic">ORG√ÅNICO</div>
                    <div class="product-image">
                        <i class="fas fa-cheese"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Queso Brie Artesanal</h3>
                        <p class="product-description">Queso brie elaborado con leche cruda de vaca, maduraci√≥n en bodega natural.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Rueda de 2.5 kg</div>
                            <div class="feature"><i class="fas fa-clock"></i> Maduraci√≥n: 60 d√≠as</div>
                            <div class="feature"><i class="fas fa-leaf"></i> Leche org√°nica certificada</div>
                            <div class="feature"><i class="fas fa-home"></i> Elaboraci√≥n artesanal</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 150.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Queso Brie Artesanal', 150000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 3: Vino Premium -->
                <div class="product-card" data-category="drinks gourmet">
                    <div class="product-badge">PREMIUM</div>
                    <div class="product-image">
                        <i class="fas fa-wine-glass-alt"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Vino Malbec Reserva</h3>
                        <p class="product-description">Vino tinto reserva 2018 de Mendoza, Argentina. Crianza 12 meses en roble franc√©s.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-wine-bottle"></i> Botella 750ml</div>
                            <div class="feature"><i class="fas fa-calendar-alt"></i> Cosecha 2018</div>
                            <div class="feature"><i class="fas fa-award"></i> 92 puntos Parker</div>
                            <div class="feature"><i class="fas fa-box"></i> Caja de regalo incluida</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 185.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Vino Malbec Reserva', 185000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 4: Aceite de Oliva -->
                <div class="product-card" data-category="gourmet organic">
                    <div class="product-badge organic">ORG√ÅNICO</div>
                    <div class="product-image">
                        <i class="fas fa-oil-can"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Aceite de Oliva Extra Virgen</h3>
                        <p class="product-description">Aceite premium primera prensada en fr√≠o, variedad arbequina. Producto org√°nico certificado.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Botella 1 litro</div>
                            <div class="feature"><i class="fas fa-snowflake"></i> Primera prensada en fr√≠o</div>
                            <div class="feature"><i class="fas fa-leaf"></i> Certificado org√°nico</div>
                            <div class="feature"><i class="fas fa-globe-europe"></i> Importado de Espa√±a</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 95.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Aceite de Oliva Extra Virgen', 95000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 5: Pan Artesanal -->
                <div class="product-card" data-category="bakery">
                    <div class="product-badge">RECI√âN HORNEADO</div>
                    <div class="product-image">
                        <i class="fas fa-bread-slice"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Pan de Masa Madre</h3>
                        <p class="product-description">Pan artesanal de fermentaci√≥n lenta (72 horas), harina org√°nica y sin conservantes.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Pieza de 800g</div>
                            <div class="feature"><i class="fas fa-clock"></i> Fermentaci√≥n: 72h</div>
                            <div class="feature"><i class="fas fa-wheat"></i> Harina org√°nica integral</div>
                            <div class="feature"><i class="fas fa-fire"></i> Horneado en piedra</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 35.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Pan de Masa Madre', 35000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 6: Caf√© Especial -->
                <div class="product-card" data-category="drinks gourmet">
                    <div class="product-badge new">NUEVO</div>
                    <div class="product-image">
                        <i class="fas fa-coffee"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Caf√© Especial Geisha</h3>
                        <p class="product-description">Caf√© de especialidad variedad Geisha, tostado medio, notas frutales y florales.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Bolsa 500g</div>
                            <div class="feature"><i class="fas fa-mountain"></i> Altura: 1800msnm</div>
                            <div class="feature"><i class="fas fa-seedling"></i> Cultivo sostenible</div>
                            <div class="feature"><i class="fas fa-trophy"></i> Premio de calidad</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 120.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Caf√© Especial Geisha', 120000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 7: Miel Org√°nica -->
                <div class="product-card" data-category="organic">
                    <div class="product-badge organic">100% NATURAL</div>
                    <div class="product-image">
                        <i class="fas fa-honey-pot"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Miel Org√°nica Multifloral</h3>
                        <p class="product-description">Miel pura de abejas sin procesar, cosechada en colmenares org√°nicos certificados.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-weight"></i> Frasco 1kg</div>
                            <div class="feature"><i class="fas fa-bee"></i> Apicultura org√°nica</div>
                            <div class="feature"><i class="fas fa-filter"></i> Sin pasteurizar</div>
                            <div class="feature"><i class="fas fa-certificate"></i> Certificado ecol√≥gico</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 65.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Miel Org√°nica Multifloral', 65000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Product 8: Cesta Regalo -->
                <div class="product-card" data-category="gourmet">
                    <div class="product-badge limited">EDICI√ìN LIMITADA</div>
                    <div class="product-image">
                        <i class="fas fa-gift"></i>
                    </div>
                    <div class="product-content">
                        <h3 class="product-name">Cesta Gourmet Navide√±a</h3>
                        <p class="product-description">Selecci√≥n premium: jam√≥n, queso, vino, aceite y dulces. Ideal para regalo empresarial.</p>
                        
                        <div class="product-features">
                            <div class="feature"><i class="fas fa-box"></i> 8 productos premium</div>
                            <div class="feature"><i class="fas fa-gift"></i> Empaque de regalo</div>
                            <div class="feature"><i class="fas fa-shipping-fast"></i> Env√≠o gratis</div>
                            <div class="feature"><i class="fas fa-edit"></i> Tarjeta personalizada</div>
                        </div>
                        
                        <div class="product-footer">
                            <div class="product-price">‚Ç≤ 850.000</div>
                            <button class="buy-btn" onclick="comprarProducto('Cesta Gourmet Navide√±a', 850000)">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Order Result Section -->
        <section class="order-result" id="order-result">
            <div class="order-header">
                <div class="order-icon">
                    <i class="fas fa-receipt"></i>
                </div>
                <h2 class="order-title">Detalles de tu Pedido</h2>
            </div>
            
            <div class="order-status" id="order-status">
                <div class="status-text" id="status-text">Procesando tu pedido...</div>
                <div class="order-id" id="order-id"></div>
            </div>
            
            <div class="order-actions" id="order-actions">
                <!-- Actions will be added dynamically -->
            </div>
            
            <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #eee;">
                <h3 style="font-size: 1rem; margin-bottom: 10px; color: var(--primary);">
                    <i class="fas fa-info-circle"></i> Informaci√≥n importante para tu compra
                </h3>
                <p style="font-size: 0.9rem; color: var(--gray);">
                    <i class="fas fa-shipping-fast" style="color: var(--secondary);"></i> Env√≠o gratis en Asunci√≥n para pedidos mayores a ‚Ç≤ 100.000<br>
                    <i class="fas fa-clock" style="color: var(--accent);"></i> Productos perecederos: entrega en 24-48 horas<br>
                    <i class="fas fa-undo" style="color: var(--success);"></i> 15 d√≠as para devoluciones de productos no perecederos<br>
                    <i class="fas fa-phone" style="color: var(--primary);"></i> Atenci√≥n al cliente: (021) 123-456
                </p>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <h3 style="color: var(--primary); margin-bottom: 15px;">
                <i class="fas fa-store"></i> Mercado Don Onofre
            </h3>
            <p>Delicatessen y productos gourmet</p>
            
            <div class="store-info">
                <div class="info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Av. Espa√±a 1234, Asunci√≥n</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-phone"></i>
                    <span>(021) 123-456</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-clock"></i>
                    <span>Lun-S√°b: 8:00-20:00</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-envelope"></i>
                    <span>info@dononofre.com.py</span>
                </div>
            </div>
            
            <p style="margin-top: 20px; font-size: 0.8rem; color: var(--gray);">
                <strong>Prueba T√©cnica Senior:</strong> Sistema de e-commerce integrado con AdamsPay para procesamiento de pagos seguros.
            </p>
        </footer>

        <!-- Cart Summary (fixed) -->
        <div class="cart-summary" id="cart-summary" style="display: none;">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-count">0</span> productos
        </div>
    </div>

    <script>
        // Estado global
        let currentOrderId = null;
        let cartItems = [];
        
        // Funci√≥n para formatear precios al estilo paraguayo (punto como separador decimal)
        function formatPricePY(price) {
            // Si el precio ya es un string con formato, extraer el n√∫mero
            if (typeof price === 'string') {
                // Extraer solo los n√∫meros (eliminar s√≠mbolos y letras)
                const numStr = price.replace(/[^\d.]/g, '');
                price = parseFloat(numStr);
            }
            
            // Convertir a n√∫mero si es string
            const numValue = typeof price === 'number' ? price : parseFloat(price);
            
            // Asegurar que tenga 3 decimales
            const withThreeDecimals = numValue.toFixed(3);
            
            // Separar parte entera y decimal
            const [integerPart, decimalPart] = withThreeDecimals.split('.');
            
            // Formatear parte entera con puntos de miles
            let formattedInteger = '';
            const integerStr = integerPart.toString();
            const len = integerStr.length;
            
            for (let i = 0; i < len; i++) {
                const digit = integerStr[len - 1 - i];
                formattedInteger = digit + formattedInteger;
                if ((i + 1) % 3 === 0 && i !== len - 1) {
                    formattedInteger = '.' + formattedInteger;
                }
            }
            
            return `${formattedInteger}.${decimalPart}`;
        }
        
        // Funci√≥n para filtrar productos
        function filterProducts(category) {
            const products = document.querySelectorAll('.product-card');
            const buttons = document.querySelectorAll('.category-btn');
            
            // Actualizar botones activos
            buttons.forEach(btn => {
                btn.classList.remove('active');
                const btnText = btn.textContent.toLowerCase();
                if (category === 'all' && btnText.includes('todos')) {
                    btn.classList.add('active');
                } else if (btnText.includes(category)) {
                    btn.classList.add('active');
                }
            });
            
            // Mostrar/ocultar productos
            products.forEach(product => {
                const productCategories = product.dataset.category.split(' ');
                
                if (category === 'all' || productCategories.includes(category)) {
                    product.style.display = 'block';
                    setTimeout(() => {
                        product.style.opacity = '1';
                        product.style.transform = 'translateY(0)';
                    }, 100);
                } else {
                    product.style.opacity = '0';
                    product.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        product.style.display = 'none';
                    }, 300);
                }
            });
        }
        
        function comprarProducto(nombreProducto, monto) {
            const orderResult = document.getElementById('order-result');
            const statusText = document.getElementById('status-text');
            const orderIdElement = document.getElementById('order-id');
            const orderActions = document.getElementById('order-actions');
            
            // Formatear el precio para mostrar
            const precioFormateado = formatPricePY(monto);
            
            // Agregar al carrito
            cartItems.push({
                name: nombreProducto,
                price: monto,
                priceFormatted: `‚Ç≤ ${precioFormateado}`,
                timestamp: new Date().toISOString()
            });
            updateCartSummary();
            
            // Mostrar secci√≥n de resultado
            orderResult.style.display = 'block';
            orderResult.scrollIntoView({ behavior: 'smooth' });
            
            // Resetear estado
            statusText.innerHTML = `
                <span style="color: #8B4513;">
                    <i class="fas fa-spinner fa-spin"></i> Preparando tu pedido...
                </span>
            `;
            orderIdElement.textContent = '';
            orderActions.innerHTML = '';
            
            // Deshabilitar botones temporalmente
            document.querySelectorAll('.buy-btn').forEach(btn => {
                const originalText = btn.innerHTML;
                btn.disabled = true;
                btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Procesando...`;
                btn.dataset.original = originalText;
            });
            
            // Formatear monto para API (centavos)
            const amountInCents = monto;
            
            // Realizar solicitud a la API
            fetch('/api/orders/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    product_name: nombreProducto,
                    amount: amountInCents,
                    currency: 'PYG'
                })
            })
            .then(async response => {
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || `Error HTTP: ${response.status}`);
                }
                
                return data;
            })
            .then(datos => {
                console.log('Respuesta del servidor:', datos);
                currentOrderId = datos.id;
                
                // Actualizar estado
                if (datos.error) {
                    statusText.innerHTML = `
                        <span style="color: #8B0000;">
                            <i class="fas fa-exclamation-circle"></i> Error: ${datos.error}
                        </span>
                    `;
                } else {
                    // Mostrar informaci√≥n del pedido
                    orderIdElement.textContent = `ID del Pedido: ${datos.id}`;
                    
                    if (datos.warning) {
                        statusText.innerHTML = `
                            <span style="color: #D2691E;">
                                <i class="fas fa-exclamation-triangle"></i> Pedido creado con advertencia: ${datos.warning}
                            </span>
                        `;
                    } else {
                        statusText.innerHTML = `
                            <span style="color: #2E8B57;">
                                <i class="fas fa-check-circle"></i> ¬°Pedido creado con √©xito!
                            </span>
                        `;
                    }
                    
                    // Mostrar acciones disponibles
                    orderActions.innerHTML = '';
                    
                    if (datos.payment_link) {
                        const paymentLink = document.createElement('a');
                        paymentLink.href = datos.payment_link;
                        paymentLink.className = 'payment-link';
                        paymentLink.target = '_blank';
                        paymentLink.innerHTML = `
                            <i class="fas fa-external-link-alt"></i>
                            Proceder al Pago con AdamsPay
                        `;
                        orderActions.appendChild(paymentLink);
                        
                        // Bot√≥n para verificar estado
                        const statusBtn = document.createElement('button');
                        statusBtn.className = 'status-btn';
                        statusBtn.innerHTML = `
                            <i class="fas fa-sync-alt"></i>
                            Verificar Estado del Pago
                        `;
                        statusBtn.onclick = () => verificarEstadoPedido(datos.id);
                        orderActions.appendChild(statusBtn);
                        
                        // Bot√≥n para seguir comprando
                        const continueBtn = document.createElement('button');
                        continueBtn.className = 'status-btn';
                        continueBtn.style.background = '#3498db';
                        continueBtn.innerHTML = `
                            <i class="fas fa-shopping-cart"></i>
                            Seguir Comprando
                        `;
                        continueBtn.onclick = () => {
                            orderResult.style.display = 'none';
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        };
                        orderActions.appendChild(continueBtn);
                        
                        // Contador para redirecci√≥n autom√°tica
                        let countdown = 8;
                        const countdownElement = document.createElement('div');
                        countdownElement.style.marginTop = '15px';
                        countdownElement.style.color = 'var(--primary)';
                        countdownElement.style.fontSize = '0.9rem';
                        countdownElement.style.fontWeight = '600';
                        countdownElement.id = 'countdown';
                        orderActions.appendChild(countdownElement);
                        
                        const countdownInterval = setInterval(() => {
                            countdownElement.innerHTML = `
                                <i class="fas fa-clock"></i>
                                Redirigiendo a AdamsPay en ${countdown} segundos...
                            `;
                            countdown--;
                            
                            if (countdown < 0) {
                                clearInterval(countdownInterval);
                                if (datos.payment_link && !datos.payment_link.includes('fallback')) {
                                    window.open(datos.payment_link, '_blank');
                                }
                            }
                        }, 1000);
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                statusText.innerHTML = `
                    <span style="color: #8B0000;">
                        <i class="fas fa-times-circle"></i> Error: ${error.message}
                    </span>
                `;
                
                // Mostrar bot√≥n para reintentar
                const retryBtn = document.createElement('button');
                retryBtn.className = 'status-btn';
                retryBtn.innerHTML = `<i class="fas fa-redo"></i> Reintentar Compra`;
                retryBtn.onclick = () => comprarProducto(nombreProducto, monto);
                orderActions.appendChild(retryBtn);
            })
            .finally(() => {
                // Rehabilitar botones
                document.querySelectorAll('.buy-btn').forEach(btn => {
                    if (btn.dataset.original) {
                        btn.disabled = false;
                        btn.innerHTML = btn.dataset.original;
                    }
                });
            });
        }
        
        function verificarEstadoPedido(idPedido) {
            const statusText = document.getElementById('status-text');
            const previousText = statusText.innerHTML;
            
            statusText.innerHTML = `
                <span style="color: #8B4513;">
                    <i class="fas fa-spinner fa-spin"></i> Consultando estado del pago...
                </span>
            `;
            
            fetch(`/api/orders/${idPedido}/`)
                .then(response => response.json())
                .then(datos => {
                    let statusColor, statusIcon, statusMessage, additionalInfo;
                    
                    switch(datos.status) {
                        case 'pending':
                            statusColor = '#8B4513';
                            statusIcon = '<i class="fas fa-clock"></i>';
                            statusMessage = 'Pendiente de pago';
                            additionalInfo = 'Por favor, completa el pago para procesar tu pedido.';
                            break;
                        case 'paid':
                            statusColor = '#2E8B57';
                            statusIcon = '<i class="fas fa-check-circle"></i>';
                            statusMessage = '¬°Pago Confirmado!';
                            additionalInfo = 'Tu pedido est√° siendo preparado para el env√≠o.';
                            break;
                        case 'failed':
                            statusColor = '#8B0000';
                            statusIcon = '<i class="fas fa-times-circle"></i>';
                            statusMessage = 'Pago Fallido';
                            additionalInfo = 'El pago no pudo ser procesado. Intenta nuevamente.';
                            break;
                        default:
                            statusColor = '#8B4513';
                            statusIcon = '<i class="fas fa-info-circle"></i>';
                            statusMessage = datos.status || 'Estado desconocido';
                            additionalInfo = 'Contacta a nuestro servicio al cliente.';
                    }
                    
                    statusText.innerHTML = `
                        <span style="color: ${statusColor}">
                            ${statusIcon} ${statusMessage}
                        </span>
                    `;
                    
                    // Mostrar alerta detallada
                    setTimeout(() => {
                        // Formatear el precio para la alerta
                        const productPrice = datos.amount ? `‚Ç≤ ${formatPricePY(datos.amount)}` : 'N/A';
                        alert(`üè™ **Mercado Don Onofre**\n\n` +
                            `üì¶ **Pedido #${idPedido}**\n` +
                            `üçΩÔ∏è **Producto:** ${datos.product_name || 'N/A'}\n` +
                            `üí∞ **Total:** ${productPrice}\n` +
                            `üìä **Estado:** ${statusMessage}\n` +
                            `üìÖ **Fecha:** ${new Date(datos.created_at).toLocaleString('es-PY')}\n\n` +
                            `üí° **Informaci√≥n:** ${additionalInfo}\n\n` +
                            `üìû **Contacto:** (021) 123-456`);
                    }, 300);
                })
                .catch(error => {
                    console.error('Error al verificar estado:', error);
                    statusText.innerHTML = previousText;
                    alert('Error al verificar el estado del pedido. Por favor, intenta nuevamente o contacta a nuestro servicio al cliente.');
                });
        }
        
        function updateCartSummary() {
            const cartSummary = document.getElementById('cart-summary');
            const cartCount = document.getElementById('cart-count');
            
            cartCount.textContent = cartItems.length;
            
            if (cartItems.length > 0) {
                cartSummary.style.display = 'flex';
                
                // Calcular total
                const total = cartItems.reduce((sum, item) => sum + item.price, 0);
                const totalFormatted = formatPricePY(total);
                
                // Mostrar tooltip con resumen
                cartSummary.title = `Productos en carrito:\n${cartItems.map(item => `‚Ä¢ ${item.name} - ‚Ç≤ ${formatPricePY(item.price)}`).join('\n')}\n\nüí∞ Total: ‚Ç≤ ${totalFormatted}`;
            }
        }
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            // Efecto de aparici√≥n suave para las tarjetas
            const cards = document.querySelectorAll('.product-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
            
            // Formatear todos los precios en la p√°gina
            document.querySelectorAll('.product-price').forEach(priceElement => {
                const originalHTML = priceElement.innerHTML;
                
                // Buscar patrones de precios (‚Ç≤ seguido de n√∫mero)
                const priceRegex = /‚Ç≤\s*([\d,.]+)/g;
                let nuevoHTML = originalHTML;
                
                let match;
                while ((match = priceRegex.exec(originalHTML)) !== null) {
                    const precioOriginal = match[1];
                    const precioFormateado = formatPricePY(precioOriginal);
                    nuevoHTML = nuevoHTML.replace(precioOriginal, precioFormateado);
                }
                
                priceElement.innerHTML = nuevoHTML;
            });
            
            // Tambi√©n formatear precios tachados (old-price)
            document.querySelectorAll('.old-price').forEach(priceElement => {
                const originalHTML = priceElement.innerHTML;
                
                // Buscar n√∫meros
                const priceRegex = /([\d,.]+)/g;
                let nuevoHTML = originalHTML;
                
                let match;
                while ((match = priceRegex.exec(originalHTML)) !== null) {
                    const precioOriginal = match[1];
                    const precioFormateado = formatPricePY(precioOriginal);
                    nuevoHTML = nuevoHTML.replace(precioOriginal, precioFormateado);
                }
                
                priceElement.innerHTML = nuevoHTML;
            });
            
            // Configurar el carrito
            const cartSummary = document.getElementById('cart-summary');
            cartSummary.addEventListener('click', () => {
                if (cartItems.length > 0) {
                    // Calcular total
                    const total = cartItems.reduce((sum, item) => sum + item.price, 0);
                    const totalFormatted = formatPricePY(total);
                    
                    alert(`üõí **Tu Carrito de Compras**\n\n` +
                        `${cartItems.map((item, index) => `${index + 1}. ${item.name} - ‚Ç≤ ${formatPricePY(item.price)}`).join('\n')}\n\n` +
                        `üí∞ **Total:** ‚Ç≤ ${totalFormatted}\n\n` +
                        `*Los productos se procesan individualmente para mejor control de inventario.`);
                }
            });
        });
    </script>
</body>
</html>